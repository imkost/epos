(()=>{const n=document;window.Epos={dynamic(n){return j(n)?((t=n)[l]||(t[f]=0,t[l]=g({value:void 0}),t[i]=h(()=>{t[l].value$=t()},!0)),e&&(t[f]+=1,N(e,()=>{t[f]-=1,u.add(function(){0===t[f]&&(t[i].stop(),t[l]=null)})})),t[l].value$):M(n)||T(n)?g(n):n;var t},autorun:h,compound(n){const t=o;o=[],n();for(const n of o)n();o=t},render:b,renderRaw(n){const t=b({});return t.innerHTML=n,Array.from(t.childNodes)},discontinue(n){}},b.addPlugin=function(n){s.push(n)};let t=null,e=null,o=null,r=1;const c=function(){const n=[];for(const t in document){const e=document[t];t.startsWith("on")&&(null===e||j(e))&&n.push(t)}return n}(),s=[],u=new Set,i=Symbol("comp"),f=Symbol("usages"),l=Symbol("source"),a=Symbol("splice"),p=Symbol("children"),d=Symbol("isStream"),m=Symbol("boundaryId");function g(n,e){return M(n)?function(n,e){const o={};for(const t in n)r(t,n[t]);return Object.defineProperties(o,{set$:{get:()=>(function(n,t){r(n,t),e&&v(e)})},delete$:{get:()=>(function(n){o[`${n}$`]=void 0,delete o[n],delete o[`${n}$`]})}}),o;function r(n,e){const r=new Set;o[n]=g(e,r),Object.defineProperty(o,`${n}$`,{configurable:!0,get:()=>(t&&t(r),o[n]),set:t=>(o[n]!==t&&(o[n]=g(t,r),v(r)),!0)})}}(n,e):T(n)?function(t,e){const o=n.map(n=>g(n));return o[a]=new Set,Object.defineProperties(o,{pop$:{get:()=>(function(){return r(o.length-1,1)[0]})},push$:{get:()=>(function(n){return r(o.length,0,n),o.length})},shift$:{get:()=>(function(){return r(0,1)[0]})},unshift$:{get:()=>(function(n){return r(0,0,n),o.length})},splice$:{get:()=>r},map$:{get:()=>(function(n){return function(n,t){const e=g(n.map(t));return e[d]=!0,$(n,(n,o,...r)=>{r=r.map(n=>t(n)),e.splice$(n,o,...r)}),e}(o,n)})}}),o;function r(n,t,...r){n<0?n=Math.max(0,o.length+n):n>o.length-1&&(n=o.length),t=Math.max(0,Math.min(o.length-n,t)),r=r.map(n=>g(n));const c=o.splice(n,t,...r);return v(o[a],n,t,...r),e&&v(e),c}}(0,e):n}function h(n,o=!1){let r=new Set;const c={stop:f,[p]:[]};return e&&!o&&e[p].push(c),s(),c;function s(){f();const o=t,r=e;t=i,e=c,n(),t=o,null===(e=r)&&(x(u),u.clear())}function i(n){n.add(s),r.add(n)}function f(){for(const n of c[p])n.stop();c[p]=[];for(const n of Array.from(r))n.delete(s);r.clear()}}function b(t){return t instanceof window.Node?t:A(t)?n.createTextNode(t):M(t)?function(t){const e=new Map;for(const n of s)if(n.preprocess){const o={};e.set(n,o),n.preprocess({state:o,template:t})}let o;const r=t.tag||"div";o=t.xmlns?n.createElementNS(t.xmlns,r):n.createElement(r);for(const n in t)if("tag"!==n&&"inner"!==n&&"xmlns"!==n){const e=t[n];c.includes(n.toLowerCase())&&j(e)?o.addEventListener(n.toLowerCase().slice(2),e):h(()=>{y(o,n,j(e)?e():e)})}const u=C(b(t.inner));for(const n of u)o.appendChild(n);for(const n of s)if(n.postprocess){const r=e.get(n);n.postprocess({state:r,template:t,node:o})}return o}(t):T(t)?S(t):j(t)?function(t){const[e,o]=w();let r,c=!0;return h(()=>{const s=C(b(t()));if(c)r=s,c=!1;else{const t=n.createDocumentFragment();for(const n of s)t.appendChild(n);for(;e.nextSibling!==o;)e.nextSibling.remove();o.parentNode.insertBefore(t,o)}}),[e,...r,o]}(t):(e=t)&&e[d]?function(n){const t=S(n),e=t[0],o=t[t.length-1];return $(n,(n,t,...r)=>{let c=0,s=e.nextSibling;if(!s)return;const u=[];for(;s!==o;){if(s[m]){const n=[],t=s[m];for(;;)if(n.push(s),(s=s.nextSibling)[m]===t){n.push(s);break}u.push(n)}else u.push(s);s=s.nextSibling}const i=[],f=C(u[n]||o)[0];for(c=0;c<t;c++){const t=C(u[n+c]);for(const n of t)i.push(n)}for(const n of r){const t=C(b(n));for(const n of t)f.parentNode.insertBefore(n,f)}for(const n of i)n.remove()}),t}(t):n.createTextNode("");var e}function y(n,t,e){A(e)||"boolean"==typeof e?t in n?n[t]=e:n.setAttribute(t,e):n.removeAttribute(t)}function S(n){const[t,e]=w();return[t,...C(n.map(b)),e]}function $(n,t){n[a].add(t),e&&N(e,()=>{n[a].delete(t)})}function x(n,...t){for(const e of Array.from(n))e(...t)}function v(n,...t){function e(){x(n,...t)}n&&(o?o.push(e):e())}function w(){const t=n.createTextNode(""),e=n.createTextNode("");return t[m]=r,e[m]=r,r+=1,[t,e]}function N(n,t){n[p].push({stop(){t()}})}function A(n){return"string"==typeof n||"number"==typeof n}function j(n){return"function"==typeof n}function M(n){return"[object Object]"==={}.toString.call(n)}function T(n){return Array.isArray(n)&&!n[d]}function C(n){return T(n)?n.flat():[n]}})();