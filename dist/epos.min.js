/**
 * Copyright (c) Konstantin Zemtsovsky
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
(()=>{const n=document,t=Array.from,e=Symbol,o=Object.defineProperties,r=()=>new Set;window.Epos={dynamic(n){return E(n)?((t=n)[g]||(t[d]=0,t[g]=x({value:void 0}),t[p]=v(()=>{t[g].value$=t()},!0)),u&&(t[d]+=1,j(u,()=>{t[d]-=1,a.add(function(){0===t[d]&&(t[p].stop(),t[g]=null)})})),t[g].value$):L(n)||O(n)?x(n):n;var t},autorun:v,compound(n){const t=s;s=[],n();for(const n of s)n();s=t},render:y,renderRaw(n){const e=y({});return e.innerHTML=n,t(e.childNodes)},discontinue(n){}},y.addPlugin=function(n){l.push(n)};let c=null,u=null,s=null,i=1;const f=function(){const n=[];for(const t in document){const e=document[t];t.startsWith("on")&&(null===e||E(e))&&n.push(t)}return n}(),l=[],a=r(),p=e(),d=e(),g=e(),h=e(),m=e(),$=e(),b=e();function x(n,t){return L(n)?function(n,t){const e={};for(const t in n)u(t,n[t]);return o(e,{set$:{get:()=>(function(n,e){u(n,e),t&&M(t)})},delete$:{get:()=>(function(n){e[`${n}$`]=void 0,delete e[n],delete e[`${n}$`]})}}),e;function u(n,t){const o=r();e[n]=x(t,o),Object.defineProperty(e,`${n}$`,{configurable:!0,get:()=>(c&&c(o),e[n]),set:t=>(e[n]!==t&&(e[n]=x(t,o),M(o)),!0)})}}(n,t):O(n)?function(t,e){const c=n.map(n=>x(n));return c[h]=r(),o(c,{pop$:{get:()=>(function(){return u(c.length-1,1)[0]})},push$:{get:()=>(function(n){return u(c.length,0,n),c.length})},shift$:{get:()=>(function(){return u(0,1)[0]})},unshift$:{get:()=>(function(n){return u(0,0,n),c.length})},splice$:{get:()=>u},map$:{get:()=>(function(n){return function(n,t){const e=x(n.map(t));return e[$]=!0,S(n,(n,o,...r)=>{r=r.map(n=>t(n)),e.splice$(n,o,...r)}),e}(c,n)})}}),c;function u(n,t,...o){n<0?n=Math.max(0,c.length+n):n>c.length-1&&(n=c.length),t=Math.max(0,Math.min(c.length-n,t)),o=o.map(n=>x(n));const r=c.splice(n,t,...o);return M(c[h],n,t,...o),e&&M(e),r}}(0,t):n}function v(n,e=!1){let o=r();const s={stop:l,[m]:[]};return u&&!e&&u[m].push(s),i(),s;function i(){l();const t=c,e=u;c=f,u=s,n(),c=t,null===(u=e)&&(A(a),a.clear())}function f(n){n.add(i),o.add(n)}function l(){for(const n of s[m])n.stop();s[m]=[];for(const n of t(o))n.delete(i);o.clear()}}function y(t){return t instanceof window.Node?t:C(t)?n.createTextNode(t):L(t)?function(t){const e=new Map;for(const n of l)if(n.preprocess){const o={};e.set(n,o),n.preprocess({state:o,template:t})}let o;const r=t.tag||"div";o=t.xmlns?n.createElementNS(t.xmlns,r):n.createElement(r);for(const n in t)if("tag"!==n&&"inner"!==n&&"xmlns"!==n){const e=t[n];f.includes(n.toLowerCase())&&E(e)?o.addEventListener(n.toLowerCase().slice(2),e):v(()=>{w(o,n,E(e)?e():e)})}const c=P(y(t.inner));for(const n of c)o.appendChild(n);for(const n of l)if(n.postprocess){const r=e.get(n);n.postprocess({state:r,template:t,node:o})}return o}(t):O(t)?N(t):E(t)?function(t){const[e,o]=T();let r,c=!0;return v(()=>{const u=P(y(t()));if(c)r=u,c=!1;else{const t=n.createDocumentFragment();for(const n of u)t.appendChild(n);for(;e.nextSibling!==o;)e.nextSibling.remove();o.parentNode.insertBefore(t,o)}}),[e,...r,o]}(t):(e=t)&&e[$]?function(n){const t=N(n),e=t[0],o=t[t.length-1];return S(n,(n,t,...r)=>{let c=0,u=e.nextSibling;if(!u)return;const s=[];for(;u!==o;){if(u[b]){const n=[],t=u[b];for(;;)if(n.push(u),(u=u.nextSibling)[b]===t){n.push(u);break}s.push(n)}else s.push(u);u=u.nextSibling}const i=[],f=P(s[n]||o)[0];for(c=0;c<t;c++){const t=P(s[n+c]);for(const n of t)i.push(n)}for(const n of r){const t=P(y(n));for(const n of t)f.parentNode.insertBefore(n,f)}for(const n of i)n.remove()}),t}(t):n.createTextNode("");var e}function w(n,t,e){C(e)||"boolean"==typeof e?t in n?n[t]=e:n.setAttribute(t,e):n.removeAttribute(t)}function N(n){const[t,e]=T();return[t,...P(n.map(y)),e]}function S(n,t){n[h].add(t),u&&j(u,()=>{n[h].delete(t)})}function A(n,...e){for(const o of t(n))o(...e)}function M(n,...t){function e(){A(n,...t)}n&&(s?s.push(e):e())}function T(){const t=n.createTextNode(""),e=n.createTextNode("");return t[b]=i,e[b]=i,i+=1,[t,e]}function j(n,t){n[m].push({stop(){t()}})}function C(n){return"string"==typeof n||"number"==typeof n}function E(n){return"function"==typeof n}function L(n){return"[object Object]"==={}.toString.call(n)}function O(n){return Array.isArray(n)&&!n[$]}function P(n){return O(n)?n.flat():[n]}})();
