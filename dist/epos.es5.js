(()=>{window.Epos={dynamic:function(n){return A(n)?((e=n)[f]||(e[i]=0,e[f]=m({value:void 0}),e[s]=g(()=>{e[f].value$=e()},!0)),t&&(e[i]+=1,w(t,()=>{e[i]-=1,u.add(function(){0===e[i]&&(e[s].stop(),e[f]=null)})})),e[f].value$):j(n)||M(n)?m(n):n;var e},autorun:g,compound:function(n){const t=e;e=[],n();for(const n of e)n();e=t},render:h,renderRaw:function(n){const t=h({});return t.innerHTML=n,Array.from(t.childNodes)},discontinue:function(n){}},h.addPlugin=function(n){c.push(n)};let n=null,t=null,e=null,o=1;const r=function(){const n=[];for(const t in document){const e=document[t];t.startsWith("on")&&(null===e||A(e))&&n.push(t)}return n}(),c=[],u=new Set,s=Symbol("comp"),i=Symbol("usages"),f=Symbol("source"),l=Symbol("splice"),a=Symbol("children"),d=Symbol("isStream"),p=Symbol("boundaryId");function m(t,e){return j(t)?function(t,e){const o={};for(const n in t)r(n,t[n]);return Object.defineProperties(o,{set$:{get:()=>(function(n,t){r(n,t),e&&x(e)})},delete$:{get:()=>(function(n){o[`${n}$`]=void 0,delete o[n],delete o[`${n}$`]})}}),o;function r(t,e){const r=new Set;o[t]=m(e,r),Object.defineProperty(o,`${t}$`,{configurable:!0,get:()=>(n&&n(r),o[t]),set:n=>(o[t]!==n&&(o[t]=m(n,r),x(r)),!0)})}}(t,e):M(t)?function(n,e){const o=t.map(n=>m(n));return o[l]=new Set,Object.defineProperties(o,{pop$:{get:()=>(function(){return r(o.length-1,1)[0]})},push$:{get:()=>(function(n){return r(o.length,0,n),o.length})},shift$:{get:()=>(function(){return r(0,1)[0]})},unshift$:{get:()=>(function(n){return r(0,0,n),o.length})},splice$:{get:()=>r},map$:{get:()=>(function(n){return function(n,t){const e=m(n.map(t));return e[d]=!0,S(n,(n,o,...r)=>{r=r.map(n=>t(n)),e.splice$(n,o,...r)}),e}(o,n)})}}),o;function r(n,t,...r){n<0?n=Math.max(0,o.length+n):n>o.length-1&&(n=o.length),t=Math.max(0,Math.min(o.length-n,t)),r=r.map(n=>m(n));const c=o.splice(n,t,...r);return x(o[l],n,t,...r),e&&x(e),c}}(0,e):t}function g(e,o=!1){let r=new Set;const c={stop:f,[a]:[]};return t&&!o&&t[a].push(c),s(),c;function s(){f();const o=n,r=t;n=i,t=c,e(),n=o,null===(t=r)&&($(u),u.clear())}function i(n){n.add(s),r.add(n)}function f(){for(const n of c[a])n.stop();c[a]=[];for(const n of Array.from(r))n.delete(s);r.clear()}}function h(n){return n instanceof window.Node?n:N(n)?document.createTextNode(n):j(n)?function(n){const t=new Map;for(const e of c)if(e.preprocess){const o={};t.set(e,o),e.preprocess({state:o,template:n})}let e;const o=n.tag||"div";e=n.xmlns?document.createElementNS(n.xmlns,o):document.createElement(o);for(const t in n)if("tag"!==t&&"inner"!==t&&"xmlns"!==t){const o=n[t];r.includes(t.toLowerCase())&&A(o)?e.addEventListener(t.toLowerCase().slice(2),o):g(()=>{b(e,t,A(o)?o():o)})}const u=T(h(n.inner));for(const n of u)e.appendChild(n);for(const o of c)if(o.postprocess){const r=t.get(o);o.postprocess({state:r,template:n,node:e})}return e}(n):M(n)?y(n):A(n)?function(n){const[t,e]=v();let o,r=!0;return g(()=>{const c=T(h(n()));if(r)o=c,r=!1;else{const n=document.createDocumentFragment();for(const t of c)n.appendChild(t);for(;t.nextSibling!==e;)t.nextSibling.remove();e.parentNode.insertBefore(n,e)}}),[t,...o,e]}(n):(t=n)&&t[d]?function(n){const t=y(n),e=t[0],o=t[t.length-1];return S(n,(n,t,...r)=>{let c=0,u=e.nextSibling;if(!u)return;const s=[];for(;u!==o;){if(u[p]){const n=[],t=u[p];for(;;)if(n.push(u),(u=u.nextSibling)[p]===t){n.push(u);break}s.push(n)}else s.push(u);u=u.nextSibling}const i=[],f=T(s[n]||o)[0];for(c=0;c<t;c++){const t=T(s[n+c]);for(const n of t)i.push(n)}for(const n of r){const t=T(h(n));for(const n of t)f.parentNode.insertBefore(n,f)}for(const n of i)n.remove()}),t}(n):document.createTextNode("");var t}function b(n,t,e){N(e)||"boolean"==typeof e?t in n?n[t]=e:n.setAttribute(t,e):n.removeAttribute(t)}function y(n){const[t,e]=v();return[t,...T(n.map(h)),e]}function S(n,e){n[l].add(e),t&&w(t,()=>{n[l].delete(e)})}function $(n,...t){for(const e of Array.from(n))e(...t)}function x(n,...t){function o(){$(n,...t)}n&&(e?e.push(o):o())}function v(){const n=document.createTextNode(""),t=document.createTextNode("");return n[p]=o,t[p]=o,o+=1,[n,t]}function w(n,t){n[a].push({stop(){t()}})}function N(n){return"string"==typeof n||"number"==typeof n}function A(n){return"function"==typeof n}function j(n){return"[object Object]"==={}.toString.call(n)}function M(n){return Array.isArray(n)&&!n[d]}function T(n){return M(n)?n.flat():[n]}})();